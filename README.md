mila
===========

Что делают выключатели М0-M1-M2 на плате
----------------------------------------

|M[2:0] | Режим | Стартовый адрес / таблица векторов прерываний | Дополнительно |
|----|----|----|----|
| 000 | Микроконтроллер в режиме отладки | 0х0800_0000 | работает JTAG_B |
| 001 | Микроконтроллер в режиме отладки | 0х0800_0000 | работает JTAG_А |
| 010 | Микропроцессор в режиме отладки  | 0х1000_0000 | ROM режим, внешняя шина, JTAG_B | 
| 011 | Микропроцессор без отладки | 0х1000_0000 | ROM режим, внешняя шина, JTAG_A |
| 100 | Зарезервировано | - |
| 101 | UART загрузчик | Определяется пользователем | через UART2 на PD[1:0] в ОЗУ |
| 110 | UART загрузчик |Определяется пользователем | через UART2 на PF[1:0] в ОЗУ |



Быстрый старт
-------------

1. Поставить [драйвера](CP2102WinDrivers) на CP2102.
2. Скачать Keil 4.7 с торрентов. Вообще он бесплатный, но в обычной ситуации надо регаться на сайте keil.
3. Поставить [пак на Keil](Milandr.MDR1986BExx.1.3.0.pack), который впиливает туда миландры.
4. На плате свичи 10 и 6 выставить в 1, 9 в 0. Подключить плату.
5. Появившийся COM-порт сменить на 1-й: Диспетчер устройств -> Райтклик по порту -> Свойства -> Параметры порта -> Дополнительно -> Номер COM-порта.
6. Запустить keil.
7. Далее по [документу](/docs/05-LDM-K1986BE92QI-manual.pdf), страницы 27-45.
8. Когда на странице 37 попросят файл system_MDR32F9x.c, берем его и хедер [тут](https://github.com/PeterBeklemishev/mila/tree/master/Standart%20Peripheral%20Library%20MDR32F9Qx%20MDR1986VE1T%20MDR1986VE3T%2BGCC/CMSIS/CM3/DeviceSupport/MDR32F9Qx/startup/arm) и копируем в папку проекта.
9. При компиляции будет ругаться на строки с MDR32F9x, ручками подставить туда Q, чтобы получилось MDR32F9Qx
10. Прошивальшик - [это он](https://github.com/PeterBeklemishev/mila/tree/master/1986UARTWSD). Кушает HEX.
11. При запущенной на камне программы прошивается только после перезагрузки платы.
